<h4 id="use-this-guide-if-there-isnt-a-guide-on-your-game-it-covers-how-to-setup-the-game-and-how-to-setup-the-options">Use this guide if there isn’t a guide on your game. It covers how to setup the game and how to setup the options.</h4>

<h2 id="launching-multiple-instances">Launching multiple instances</h2>
<h3 id="for-most-steam-games">For most Steam games</h3>
<p>Right-click it on Steam -&gt; Properties -&gt; Local files -&gt; Browse game files… to open the game directory.</p>

<p>You will need to find an executable(exe) file for the game. 
If this isn’t in the immediate directory, try looking in folders named <code class="language-plaintext highlighter-rouge">bin</code>/<code class="language-plaintext highlighter-rouge">win32</code>/<code class="language-plaintext highlighter-rouge">win64</code> or similar.</p>

<p>Try launching the exe multiple times. 
If it doesn’t let you open multiple instances, you will probably need to manipulate steam_api.dll</p>

<h3 id="manipulating-steam_apidll">Manipulating steam_api.dll</h3>
<p>Search for steam_api.dll and/or steam_api64.dll in the game directory.</p>

<p>When you find it, try renaming it to steam_api.dll.disabled (or anything) and launch the executables again.</p>

<p>If this doesn’t work, e.g. it gives a “Couldn’t load steam_api.dll” error, you will need a replacement for steam_api.dll. 
See the guide on the <a href="https://universalsplitscreen.github.io/docs/goldberg/">Goldberg Emulator</a>.</p>

<h3 id="closing-a-mutex">Closing a Mutex</h3>
<p>Some games will open a mutex that indicates to any other process that the game is already running, to prevent multiple instances.
You can close these mutexes with Process Explorer. Download it <a href="https://docs.microsoft.com/en-us/sysinternals/downloads/process-explorer">here</a>.</p>
<ol>
  <li>Run Process Explorer as administrator by right-clicking -&gt; Run as administrator.</li>
  <li>Scroll down to the game process in the list. Press Ctrl+H to open the list of handles.</li>
  <li>Scroll down to the Mutex types.</li>
  <li>Try and find a mutex with a name related to the game, e.g. hl2_singleton_mutex. Right-click -&gt; Close Handle.
    <ul>
      <li>It may sometimes not by a Mutex type, e.g. it could be an Event type.</li>
    </ul>
  </li>
  <li>Try launching the game again from the executable.</li>
  <li>Repeat until you are able to launch a second instance.</li>
</ol>

<p>Once you have identified the handle name, you can use the <code class="language-plaintext highlighter-rouge">Handle unlocker</code> button in Universal Split Screen. Enter the handle name in the text box and click the button to close it for the targeted game.</p>

<h2 id="connecting-the-instances">Connecting the instances.</h2>
<p>Most games will have a LAN (Local Area Network) option that will allow you to connect to a server running on the same machine. 
Start a server as you normally would, then search for servers on LAN.</p>

<p>If the game has a direct connect option, enter <code class="language-plaintext highlighter-rouge">127.0.0.1</code> or <code class="language-plaintext highlighter-rouge">localhost</code> as the server IP address. For the port, leave it as default or use whatever the server is hosting on.</p>

<p>If the game only accepts connections via Steam invites, see the guide on the <a href="https://universalsplitscreen.github.io/docs/goldberg/">Goldberg Emulator</a>. It will allow you to trick the invite system.</p>

<h2 id="setting-up-universal-split-screen">Setting up Universal Split Screen</h2>
<p>Before starting, see the <a href="https://universalsplitscreen.github.io/docs/importantnotes/">Important Notes</a> section.</p>

<p>See the <a href="https://universalsplitscreen.github.io/docs/quickstart/">Quick Start guide</a> for installation instructions and how to configure input devices.</p>

<p>You will need to work out which options are required by the game. All the options are labelled if you hover over them.</p>

<p>The first thing you should try to get working is keyboard input. 
It will work for most games if the game is tricked into thinking it is the foreground window, which is the first step.</p>

<p>The options you should all enable at first are <code class="language-plaintext highlighter-rouge">Send normal mouse</code>, <code class="language-plaintext highlighter-rouge">Send normal keyboard</code>, <code class="language-plaintext highlighter-rouge">Send fake window activate</code>, <code class="language-plaintext highlighter-rouge">Send fake window focus</code>, <code class="language-plaintext highlighter-rouge">Hook GetForegroundWindow</code>, <code class="language-plaintext highlighter-rouge">Hook GetCursorPos</code>, <code class="language-plaintext highlighter-rouge">Hook SetCursorPos</code> and <code class="language-plaintext highlighter-rouge">Hook GetAsyncKeyState</code></p>

<p>Start split screen and see what results you get. If the game responds to any input, you have tricked it into thinking it’s in the foreground.</p>

<p>If keyboard input isn’t working at this point, try enabling <code class="language-plaintext highlighter-rouge">Send raw keyboard</code>, <code class="language-plaintext highlighter-rouge">Hook GetKeyState for WASD keys</code> and <code class="language-plaintext highlighter-rouge">Hook GetAsyncKeyState</code>.</p>

<p>When testing mouse input, there are a few components that need to work: Camera in first person games, clicking in first person, moving the mouse in menus, clicking in menus and whether the game distinguishes mouse devices. Make sure to test each one after changing options.</p>

<p>If you find that the game is confused where the mouse pointer is (ie it keeps moving towards the real Windows mouse cursor), try enabling <code class="language-plaintext highlighter-rouge">Filter mouse input messages from Windows</code>. Disable this if it doesn’t work, as it can cause issues.</p>

<p>If you want to use controllers, make sure to enable <code class="language-plaintext highlighter-rouge">Hook XInput for gamepads</code></p>

<p>If the game uses raw input and isn’t responding to any mouse input, try enabling <code class="language-plaintext highlighter-rouge">Send raw mouse input</code>. 
Make sure anything related to raw input is turned on in the game’s options.
This isn’t recommended unless necessary, since it has the worst performance.</p>

<p>If the game is responding to multiple mice, try enabling <code class="language-plaintext highlighter-rouge">Filter raw input messages from Windows</code>.</p>

<p>If mouse input isn’t working at this stage, it’s likely that the game uses a legacy mouse input method. 
Make sure to <strong><em>disable</em></strong> anything to do with raw input, in the options and the game itself, and enable <code class="language-plaintext highlighter-rouge">Send normal mouse input</code>, <code class="language-plaintext highlighter-rouge">Hook GetCursorPos</code>, <code class="language-plaintext highlighter-rouge">Hook SetCursorPos</code> and <code class="language-plaintext highlighter-rouge">Use legacy input</code>. <code class="language-plaintext highlighter-rouge">Update absolute position flag in mouse move messages</code> is also highly recommended for legacy input, especially if you notice sudden jerks in movement.</p>

<p>To make sure the fake mouse cursor is hidden/shown when needed, check <code class="language-plaintext highlighter-rouge">Hook mouse visibility</code>. This is useful in a first person game where the cursor should stay hidden unless in a UI menu.</p>

<p>Once you have input working correctly, try disabling the options one by one until you have the minimal setup.</p>

<p>Save your options as a preset by clicking New, typing a name <strong>and clicking Save</strong>.</p>

<p>Please report your results (positive or negative) in the <a href="https://github.com/UniversalSplitScreen/UniversalSplitScreen/issues">GitHub issue tracker</a> or e-mail me (ilyaki@pm.me). Please send the options you used and the steps you followed.</p>
